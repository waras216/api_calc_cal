[phases.setup]
nixPkgs = [
    "python3",
    "mariadb" 
]

[phases.install]
# **CORRECCIÓN CLAVE:** Crear el venv, y luego, usando && para encadenar comandos en la misma sesión de shell: 
# 1. Activar el venv (. .venv/bin/activate)
# 2. Instalar las dependencias (pip install -r requirements.txt)
cmds = [
    "python -m venv .venv && . .venv/bin/activate && pip install -r requirements.txt"
]

[start]
# El comando de inicio también debe activar el venv en la sesión del servidor.
cmd = ". .venv/bin/activate && gunicorn backend_calories_calc.wsgi:application --bind 0.0.0.0:$PORT"